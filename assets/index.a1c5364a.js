var P=Object.defineProperty;var u=Object.getOwnPropertySymbols;var C=Object.prototype.hasOwnProperty,w=Object.prototype.propertyIsEnumerable;var g=(i,e,t)=>e in i?P(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,_=(i,e)=>{for(var t in e||(e={}))C.call(e,t)&&g(i,t,e[t]);if(u)for(var t of u(e))w.call(e,t)&&g(i,t,e[t]);return i};var p=(i,e)=>{var t={};for(var s in i)C.call(i,s)&&e.indexOf(s)<0&&(t[s]=i[s]);if(i!=null&&u)for(var s of u(i))e.indexOf(s)<0&&w.call(i,s)&&(t[s]=i[s]);return t};var d=(i,e,t)=>(g(i,typeof e!="symbol"?e+"":e,t),t);import{l as j,y,j as A,a as E,g as m,s as I,A as x,h as O,S as k}from"./vendor.60f3588c.js";const F=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))s(l);new MutationObserver(l=>{for(const o of l)if(o.type==="childList")for(const n of o.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&s(n)}).observe(document,{childList:!0,subtree:!0});function t(l){const o={};return l.integrity&&(o.integrity=l.integrity),l.referrerpolicy&&(o.referrerPolicy=l.referrerpolicy),l.crossorigin==="use-credentials"?o.credentials="include":l.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(l){if(l.ep)return;l.ep=!0;const o=t(l);fetch(l.href,o)}};F();const v=()=>({width:window.innerWidth,height:window.innerHeight}),N=(i=250)=>{const[e,t]=j(v());return y(()=>{let s=0;const l=()=>{s&&clearTimeout(s),s=window.setTimeout(()=>{s=0,t(v())},i)};return window.addEventListener("resize",l),()=>window.removeEventListener("resize",l)},[]),e};class R{constructor(e,t){d(this,"_cols");d(this,"_rows");d(this,"_cells");d(this,"_onChange");this._cols=e,this._rows=t,this._cells=this.createCells(),this._onChange=()=>{}}createCells(e=this.length){return new Uint8Array(e)}setCells(e){this._cells=e,this._onChange()}setSize(e,t){const s=this.createCells(e*t);this._cols=e,this._rows=t,this.setCells(s)}get cols(){return this._cols}set cols(e){this.setSize(e,this.rows)}get rows(){return this._rows}set rows(e){this.setSize(this.cols,e)}get length(){return this._cols*this._rows}get liveLength(){return this._cells.reduce((e,t)=>e+t)}get deadLength(){return this.length-this.liveLength}set onChange(e){this._onChange=e}coord2index(e,t){const s=e+t*this.cols;return typeof this._cells[s]!="undefined"?s:-1}cellsForEach(e){for(let t=0;t<this._rows;t++)for(let s=0;s<this._cols;s++)e(s,t,!!this._cells[s+t*this._cols])}next(){const{cols:e,rows:t,_cells:s}=this,l=this.createCells();for(let o=0;o<t;o++)for(let n=0;n<e;n++){let r=0;o-1>=0&&(r+=n-1>=0?s[n-1+(o-1)*e]:0,r+=s[n+(o-1)*e],r+=n+1<e?s[n+1+(o-1)*e]:0),r+=n-1>=0?s[n-1+o*e]:0,r+=n+1<e?s[n+1+o*e]:0,o+1<t&&(r+=n-1>=0?s[n-1+(o+1)*e]:0,r+=s[n+(o+1)*e],r+=n+1<e?s[n+1+(o+1)*e]:0),l[n+o*e]=r===3||r===2&&s[n+o*e]?1:0}this._cells=l,this._onChange()}clear(){for(let e=0,t=this._cells.length;e<t;e++)this._cells[e]=0;this._onChange()}random(e=.2){for(let t=0,s=this._cells.length;t<s;t++)this._cells[t]=Math.random()<e?1:0;this._onChange()}getCell(e,t){const s=this.coord2index(e,t);return this._cells[s]}setCell(e,t,s){const l=this.coord2index(e,t);l>=0&&(this._cells[l]=s,this._onChange())}touchCell(e,t){this.setCell(e,t,1)}killCell(e,t){this.setCell(e,t,0)}toggleCell(e,t){const s=this.getCell(e,t);this.setCell(e,t,s?0:1)}touchCells(e){for(let t=0;t<e.length;t++){const[s,l]=e[t],o=this.coord2index(s,l);o>=0&&(this._cells[o]=1)}this._onChange()}createFromMatrix(e,t=0,s=0){const l=[];for(let o=0;o<e.length;o++)for(let n=0;n<e[o].length;n++)e[o][n]&&l.push([n+t,o+s]);this.touchCells(l)}}const h=A,L=E,S=m(i=>{console.log("Canvas");const o=i,{onMount:e,onUnmount:t}=o,s=p(o,["onMount","onUnmount"]),l=I(null);return y(()=>{const n=l.current,r=n==null?void 0:n.getContext("2d");if(n&&r)return console.log("CanvasOnMount"),e&&e(n,r),()=>{console.log("CanvasOnUnMount"),t&&t(n,r)}},[]),h("canvas",_({ref:l},s))}),b=(i,e,t,s)=>{i.width=t.cols*s,i.height=t.rows*s,e.fillStyle="gray",e.fillRect(0,0,t.cols*s,t.rows*s),e.fillStyle="green",t.cellsForEach((l,o,n)=>{n&&e.fillRect(l*s,o*s,s,s)})},U=m(({lifeGame:i,cellSize:e=1,style:t={}})=>{console.log("LifeGameCanvas");const s=x((o,n)=>{i.onChange=()=>{console.log("onChange"),b(o,n,i,e)},b(o,n,i,e)},[e]),l=x(()=>{i.onChange=()=>{}},[]);return h(S,{onMount:s,onUnmount:l,style:t})}),c=new R(1,1),f=4;let a=0;const M=()=>{a||(a=window.setInterval(()=>{c.next()},200))},z=()=>{a&&(window.clearInterval(a),a=0)},V=()=>{a?z():M()};function T(){console.log("App");const{width:i,height:e}=N();return O(()=>{const t=c.length===1,s=Math.floor(i/f),l=Math.floor(e/f);c.setSize(s,l),t&&(c.random(),M())},[i,e]),L("div",{style:"position: absolute; left: 0; top: 0; width: 100%; height: 100%",children:[h(U,{lifeGame:c,cellSize:f,style:"width: 100%; height: 100%"}),L("div",{style:"position: absolute; bottom: 5px; right: 5px",children:[h("button",{onClick:()=>V(),children:"Play/Pause"}),h("button",{onClick:()=>c.next(),children:"Next"}),h("button",{onClick:()=>c.random(),children:"Random"}),h("button",{onClick:()=>{c.clear(),c.createFromMatrix([[0,1,0],[0,0,1],[1,1,1]],5,5)},children:"Glider"})]})]})}k(h(T,{}),document.getElementById("App"));
